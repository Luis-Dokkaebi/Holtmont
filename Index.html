<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Holtmont V87</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    :root { --sidebar-w: 260px; --primary: #1e1e2d; --accent: #3699ff; --bg-body: #f3f6f9; }
    body { font-family: 'Roboto', sans-serif; background: var(--bg-body); margin: 0; overflow: hidden; font-size: 13px; }
    /* EXCEL TABLES */
    .excel-container { background: white; border: 1px solid #c0c0c0; overflow: auto; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 15px; width: 100%; }
    .table-excel { width: max-content; min-width: 100%; border-collapse: collapse; background-color: #fff; table-layout: fixed; }
    .table-excel th { background-color: #f3f3f3; color: #333; font-weight: 600; text-align: center; border: 1px solid #c0c0c0; padding: 8px 4px; font-size: 12px; position: sticky; top: 0; z-index: 10; white-space: nowrap; box-shadow: 0 1px 0 #ccc; }
    .table-excel td { border: 1px solid #d4d4d4; padding: 0; margin: 0; height: 32px; vertical-align: top; }
    .excel-input { width: 100%; min-height: 30px; height: 100%; border: none; padding: 6px 8px; outline: none; font-size: 13px; background: transparent; display: block; font-family: inherit; line-height: 1.4; white-space: nowrap; overflow: hidden; text-overflow: clip; }
    .excel-input:focus { outline: 2px solid #217346; outline-offset: -2px; z-index: 2; position: relative; background: white; }
    .input-row { background-color: #f0fdf4; } 
    .row-num { background-color: #f3f3f3; text-align: center; color: #666; font-weight: bold; width: 40px; border-right: 3px solid #ccc !important; }
    /* LAYOUT */
    .app-wrapper { display: flex; height: 100vh; width: 100vw; }
    .sidebar { width: var(--sidebar-w); background: var(--primary); color: #a2a3b7; display: flex; flex-direction: column; }
    .menu { flex: 1; overflow-y: auto; padding: 20px 0; }
    .nav-item { padding: 12px 25px; cursor: pointer; display: flex; align-items: center; color: #a2a3b7; transition: 0.2s; }
    .nav-item:hover { color: white; background: rgba(255,255,255,0.03); }
    .nav-item.active { background: #1b1b29; color: var(--accent); border-right: 3px solid var(--accent); }
    .content-wrapper { flex: 1; display: flex; flex-direction: column; background: var(--bg-body); }
    .top-bar { height: 70px; background: white; border-bottom: 1px solid #eff2f5; display: flex; align-items: center; justify-content: space-between; padding: 0 30px; }
    .view-area { flex: 1; overflow-y: auto; padding: 30px; }
    /* LOGIN */
    .login-overlay { position: fixed; inset: 0; background: var(--primary); z-index: 2000; display: flex; align-items: center; justify-content: center; }
    .login-card { background: white; padding: 40px; border-radius: 15px; width: 100%; max-width: 400px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
    .login-logo { max-width: 150px; margin-bottom: 20px; display: block; margin-left: auto; margin-right: auto; }
    /* UTILS */
    .dept-card, .staff-card { background: white; border-radius: 12px; box-shadow: 0 0 20px 0 rgba(0,0,0,0.03); padding: 20px; text-align: center; cursor: pointer; transition: 0.3s; }
    .dept-card:hover, .staff-card:hover { transform: translateY(-5px); border-color: var(--accent); }
    .form-container-pro { background: white; border-radius: 12px; padding: 40px; max-width: 1000px; margin: 0 auto; }
    .chip-container { border: 1px solid #ccc; background: white; padding: 2px; display: flex; flex-wrap: wrap; gap: 2px; min-height: 100%; align-items: center; }
    .user-chip { background: #e8f0fe; border: 1px solid #d2e3fc; border-radius: 4px; padding: 0 4px; font-size: 11px; display: flex; align-items: center; gap: 4px; white-space: nowrap; }
    .file-input-hidden { display: none; } 
    .btn-attach { border: 1px solid #ccc; background: #f8f9fa; color: #666; padding: 4px 10px; font-size: 12px; border-radius: 4px; cursor: pointer; }
    .btn-attach:hover { background: #e2e6ea; }
    .btn-attach.has-file { background: #d4edda; color: #155724; border-color: #c3e6cb; }
    .iframe-container { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: white; display: flex; flex-direction: column; }
    .iframe-toolbar { height: 45px; background: #333; color: white; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; }
    iframe { flex: 1; width: 100%; border: none; }
  </style>
</head>
<body>

<div id="app">
  <div v-if="!isLoggedIn" class="login-overlay">
    <div class="login-card">
      <img src="https://drive.google.com/thumbnail?id=1tmNuwauWNjOhv0JwX6ug9pzvsrBCNX7z&sz=w1000" class="login-logo" alt="Holtmont Logo">
      <h3 class="fw-bold mb-4 text-dark">HOLTMONT V87</h3>
      <p class="text-muted mb-4">Acceso Seguro</p>
      <div class="mb-3">
          <input type="text" v-model="loginUser" class="form-control text-center mb-2" placeholder="Usuario">
          <input type="password" v-model="loginPass" class="form-control text-center" placeholder="Contraseña..." @keyup.enter="doLogin">
      </div>
      <button class="btn btn-success w-100" @click="doLogin" :disabled="loggingIn">
        <span v-if="loggingIn">Conectando...</span><span v-else>Iniciar Sesión</span>
      </button>
    </div>
  </div>

  <div v-if="isLoggedIn" class="app-wrapper">
    <aside class="sidebar">
      <div class="brand"><i class="fas fa-table me-2 text-primary"></i> HOLTMONT</div>
      <div class="menu">
        <div class="nav-item" :class="{ active: currentView === 'DASHBOARD' }" @click="goHome"><i class="fas fa-th me-2"></i> Dashboard</div>
        <div v-if="config.specialModules.length"><div style="padding:15px 20px 5px;font-size:0.7rem;color:#888;font-weight:bold">ACCIONES</div><div class="nav-item" v-for="m in config.specialModules" @click="openModule(m)"><i class="fas me-2" :class="m.icon" :style="{color:m.color}"></i>{{m.label}}</div></div>
        <div v-if="Object.keys(config.departments).length"><div style="padding:15px 20px 5px;font-size:0.7rem;color:#888;font-weight:bold">ÁREAS</div><div class="nav-item" v-for="(d,k) in config.departments" @click="selectDept(k)"><i class="fas me-2" :class="d.icon"></i>{{d.label}}</div></div>
        <div class="mt-auto p-3"><button class="btn btn-outline-secondary w-100 btn-sm" @click="logout">Salir</button></div>
      </div>
    </aside>

    <main class="content-wrapper">
      <div class="top-bar">
        <h6 class="m-0 fw-bold text-secondary">{{ pageTitle }}</h6>
        <span class="badge bg-light text-dark border">{{ currentUser }}</span>
      </div>

      <div class="view-area" v-if="!['IFRAME', 'MODULE_TABS'].includes(currentView)">
        <div v-if="currentView === 'DASHBOARD'" class="row g-3">
          <div class="col-md-4 col-lg-3" v-for="mod in config.specialModules">
            <div class="dept-card" @click="openModule(mod)" :style="{borderTop: '4px solid '+mod.color}"><i class="fas fa-2x mb-3" :class="mod.icon" :style="{color: mod.color}"></i><h6 class="fw-bold">{{mod.label}}</h6></div>
          </div>
          <div class="col-md-4 col-lg-3" v-for="(dept, key) in config.departments">
            <div class="dept-card" @click="selectDept(key)" :style="{borderTop: '4px solid '+dept.color}"><i class="fas fa-2x mb-3" :class="dept.icon" :style="{color: dept.color}"></i><h6 class="fw-bold">{{dept.label}}</h6></div>
          </div>
        </div>

        <div v-if="currentView === 'DEPT'">
          <div class="d-flex justify-content-between mb-3"><button class="btn btn-light btn-sm border" @click="goHome">Atrás</button><input v-model="searchQuery" class="form-control form-control-sm w-auto" placeholder="Filtrar..."></div>
          <div class="row g-2"><div class="col-md-3" v-for="p in filteredStaff"><div class="staff-card h-100" @click="openStaffTracker(p)"><div class="mb-2 fw-bold text-secondary" style="font-size:1.2rem">{{p.name.charAt(0)}}</div><div class="small fw-bold">{{p.name}}</div></div></div></div>
        </div>

        <div v-if="currentView === 'STAFF_TRACKER'" class="h-100 d-flex flex-column">
          <div class="d-flex justify-content-between mb-2 p-1 bg-white border rounded">
            <div><button class="btn btn-light btn-sm border me-2" @click="goBackToDept">Volver</button><span class="small fw-bold text-success"><i class="fas fa-file-excel me-1"></i> {{ staffTracker.name }}</span></div>
            <div><button class="btn btn-success btn-sm me-1" @click="addNewRow"><i class="fas fa-plus"></i> Fila</button><button class="btn btn-outline-secondary btn-sm" @click="reloadStaffTracker"><i class="fas fa-sync"></i></button></div>
          </div>
          <div class="excel-container flex-fill mb-2">
             <div v-if="staffTracker.isLoading" class="text-center p-5 text-muted">Cargando...</div>
             <table v-else class="table-excel">
                <thead><tr><th class="row-num">#</th><th style="width:40px"><i class="fas fa-save"></i></th>
                <th v-for="h in staffTracker.headers" :key="h" 
                    :style="{ 
                        width: (h.toUpperCase()==='CONCEPTO') ? '1200px' : 
                               (h.toUpperCase()==='FOLIO' || h.toUpperCase()==='AREA' || h.toUpperCase()==='ALTA') ? '50px' : 
                               (h.toUpperCase()==='DIAS'||h.toUpperCase()==='RELOJ'||h.toUpperCase().includes('AVANCE')) ? '80px' : 
                               (h.toUpperCase()==='CLIENTE') ? '200px' :
                               '120px' 
                    }">{{h}}</th></tr></thead>
                <tbody>
                   <tr v-for="(row, i) in staffTracker.data" :key="i" :class="{'new-row-highlight': row._isNew}">
                      <td class="row-num">{{i+1}}</td><td class="text-center" style="background:#f8f9fa"><button class="btn btn-link btn-sm p-0 text-success" @click="saveRow(row)"><i class="fas fa-save"></i></button></td>
                      <td v-for="h in staffTracker.headers" :key="h">
                         <div v-if="['AREA','ALTA'].includes(h.toUpperCase())" class="text-center fw-bold" style="padding-top:6px">{{ row[h] ? row[h].toString().charAt(0).toUpperCase() : '' }}</div>
                         <input v-else-if="h.toUpperCase()==='CLIENTE'" v-model="row[h]" class="excel-input" spellcheck="false">
                         <select v-else-if="h.toUpperCase()==='CLASIFICACION'" v-model="row[h]"><option value="">-</option><option value="A">A (3d)</option><option value="AA">AA (7d)</option><option value="AAA">AAA (30d)</option></select>
                         <input v-else-if="['DIAS','RELOJ'].includes(h.toUpperCase())" v-model="row[h]" style="text-align:center;font-weight:bold" :style="getTrafficStyle(row)">
                         <input v-else-if="h.includes('AVANCE')" v-model="row[h]" style="text-align:center; font-weight:bold; color:#217346;">
                         <input v-else v-model="row[h]" class="excel-input" spellcheck="false">
                      </td>
                   </tr>
                </tbody>
             </table>
          </div>
          <div class="excel-container flex-fill" v-if="staffTracker.history.length" style="max-height:30%">
             <div class="sticky-top bg-light border-bottom px-2 small fw-bold text-muted">HISTORIAL</div>
             <table class="table-excel"><tbody><tr v-for="(row, i) in staffTracker.history"><td class="row-num">H{{i+1}}</td><td style="width:40px;text-align:center"><i class="fas fa-check text-muted small"></i></td><td v-for="h in staffTracker.headers" :style="{width: h.toUpperCase()==='CONCEPTO' ? '1200px' : '120px'}">{{row[h]}}</td></tr></tbody></table>
          </div>
        </div>

        <div v-if="currentView === 'PPC_FORM'" class="h-100 d-flex flex-column" style="background:white; padding:20px;">
           <div class="d-flex justify-content-between align-items-center mb-3">
               <h5 class="m-0 text-primary"><i class="fas fa-th me-2"></i>PPC Maestro</h5>
               <button class="btn btn-light border" @click="goHome">Cerrar</button>
           </div>
           <div class="excel-container flex-fill mb-3">
               <table class="table-excel">
                   <thead><tr><th class="row-num">#</th><th style="width:100px">Depto</th><th style="width:60px">Clasif</th><th style="min-width:1200px">Actividad (Concepto)</th><th style="width:200px">Responsables</th><th style="width:60px">Hrs</th><th style="width:60px">Cumpl.</th><th style="width:60px">Clip</th><th style="min-width:150px">Comentarios</th><th style="width:50px"></th></tr></thead>
                   <tbody>
                       <tr class="input-row">
                           <td class="row-num">></td>
                           <td><select v-model="ppcData.especialidad" class="excel-input" style="background:#f0fdf4"><option value="" disabled>Sel...</option><option v-for="(d,k) in config.departments" :value="k">{{d.label}}</option></select></td>
                           <td><select v-model="ppcData.clasificacion" class="excel-input" style="background:#f0fdf4"><option>A</option><option>AA</option><option>AAA</option></select></td>
                           <td><input v-model="ppcData.concepto" class="excel-input" placeholder="Escribir..." style="background:#f0fdf4"></td>
                           <td style="background:#f0fdf4; position:relative;"><div class="chip-container" @click="$refs.chipIn.focus()"><span v-for="(u,i) in selectedResponsables" class="user-chip">{{u}}<i class="fas fa-times ms-1 text-danger" style="cursor:pointer" @click.stop="selectedResponsables.splice(i,1)"></i></span><input ref="chipIn" v-model="staffSearch" style="border:none;outline:none;min-width:40px;font-size:12px;background:transparent;" placeholder="+"></div><ul class="list-group position-absolute w-100 shadow" style="z-index:100;max-height:150px;overflow:auto;top:100%;left:0" v-if="staffSearch"><li v-for="p in filteredDirectory" class="list-group-item list-group-item-action small py-1" @click="addResponsable(p.name)">{{p.name}}</li></ul></td>
                           <td><input v-model="ppcData.horas" class="excel-input" style="background:#f0fdf4"></td>
                           <td><select v-model="ppcData.cumplimiento" class="excel-input" style="background:#f0fdf4"><option value="NO">NO</option><option value="SI">SI</option></select></td>
                           <td class="text-center" style="background:#f0fdf4"><button class="btn-attach" :class="{'has-file': uploadSuccess}" @click="openFileDialog"><i class="fas" :class="uploadSuccess ? 'fa-check' : 'fa-paperclip'"></i></button><input type="file" ref="fileInput" class="file-input-hidden" @change="handleFileSelect"></td>
                           <td><input v-model="ppcData.comentarios" class="excel-input" placeholder="Notas..." style="background:#f0fdf4"></td>
                           <td class="text-center"><button class="btn btn-primary btn-sm py-0" @click="addToQueue">+</button></td>
                       </tr>
                       <tr v-for="(item, idx) in activityQueue" :key="idx">
                           <td class="row-num">{{ idx + 1 }}</td>
                           <td><input :value="item.especialidad" readonly class="excel-input"></td>
                           <td><input :value="item.clasificacion" readonly class="excel-input"></td>
                           <td><input :value="item.concepto" readonly class="excel-input"></td>
                           <td><div style="padding:0 8px; overflow:hidden; white-space:nowrap; font-size:12px">{{ item.responsable }}</div></td>
                           <td><input :value="item.horas" readonly class="excel-input"></td>
                           <td><input :value="item.cumplimiento" readonly class="excel-input"></td>
                           <td class="text-center"><i class="fas fa-file-pdf text-danger" v-if="item.archivoUrl"></i></td>
                           <td><input :value="item.comentarios" readonly class="excel-input"></td>
                           <td class="text-center"><i class="fas fa-trash text-danger" style="cursor:pointer" @click="activityQueue.splice(idx,1)"></i></td>
                       </tr>
                   </tbody>
               </table>
           </div>
           <div class="d-flex justify-content-end"><button class="btn btn-success fw-bold" @click="submitBatch" :disabled="isSubmitting || !activityQueue.length">{{ isSubmitting ? 'Procesando...' : 'GUARDAR TODO' }}</button></div>
        </div>
      </div>
      <div v-if="['IFRAME', 'MODULE_TABS'].includes(currentView)" class="iframe-container"><div class="iframe-toolbar"><span class="fw-bold">{{ iframeTitle }}</span><button class="btn btn-sm btn-danger" @click="closeIframe">Cerrar</button></div><iframe :src="currentIframeUrl"></iframe></div>
    </main>
  </div>
</div>

<script>
  const { createApp, ref, computed, nextTick } = Vue;
  createApp({
    setup() {
      const isLoggedIn = ref(false); const loginPass = ref(''); const loginUser = ref(''); const loggingIn = ref(false); const currentUser = ref('');
      const currentView = ref('DASHBOARD'); const currentDept = ref(''); const sidebarOpen = ref(false);
      const config = ref({ departments: {}, staff: [], directory: [], specialModules: [] });
      const staffTracker = ref({ name: '', data: [], history: [], headers: [], isLoading: false, previousView: 'DEPT' });
      const searchQuery = ref(''); const ppcData = ref({ cumplimiento: 'NO', cliente: '' }); const isSubmitting = ref(false);
      const selectedResponsables = ref([]); const staffSearch = ref(''); const activityQueue = ref([]); 
      const isUploadingFile = ref(false); const uploadSuccess = ref(false); const fileInput = ref(null);
      const currentModuleId = ref(''); const currentIframeUrl = ref(''); const iframeTitle = ref(''); const showSalesModal = ref(false); const salesData = ref([]); const salesHeaders = ref([]);

      const getTrafficStyle = (row) => {
          const t = String(row['CLASIFICACION']||'').trim().toUpperCase(); const d = parseInt(row['DIAS']||row['RELOJ']||0);
          if(t==='A') return d>=3?{bg:'#e74c3c',c:'white'}:(d===2?{bg:'#f1c40f',c:'black'}:{bg:'#2ecc71',c:'white'});
          if(t==='AA') return d>=7?{bg:'#e74c3c',c:'white'}:(d>=4?{bg:'#f1c40f',c:'black'}:{bg:'#2ecc71',c:'white'});
          if(t==='AAA') return d>=30?{bg:'#e74c3c',c:'white'}:(d>=11?{bg:'#f1c40f',c:'black'}:{bg:'#2ecc71',c:'white'});
          return {};
      };
      const trafficStyleObj = (s) => s.bg ? {backgroundColor:s.bg,color:s.c} : {};
      const handleErr = (e) => { loggingIn.value=false; staffTracker.value.isLoading=false; Swal.fire('Error',e.message,'error'); };

      const doLogin = () => {
         if(!loginPass.value || !loginUser.value) return; loggingIn.value=true;
         google.script.run.withSuccessHandler(res => { loggingIn.value=false; if(res.success){ isLoggedIn.value=true; currentUser.value=res.name; loadConfig(res.role); } else Swal.fire('Error',res.message,'error'); }).withFailureHandler(handleErr).apiLogin(loginUser.value, loginPass.value);
      };
      const loadConfig = (r) => google.script.run.withSuccessHandler(d => config.value=d).getSystemConfig(r);
      const logout = () => { isLoggedIn.value=false; loginPass.value=''; loginUser.value=''; currentView.value='DASHBOARD'; };
      
      const goHome = () => currentView.value='DASHBOARD';
      const selectDept = (k) => { currentDept.value=k; currentView.value='DEPT'; searchQuery.value=''; };
      const goBackToDept = () => currentView.value=staffTracker.value.previousView;
      const openModule = (m) => { if(m.type==='mirror_staff') openStaffTracker({name:m.target}); else if(m.type==='ppc_native') currentView.value='PPC_FORM'; };
      const closeIframe = () => currentView.value='DASHBOARD';

      const openStaffTracker = (p) => {
         staffTracker.value.name=p.name; staffTracker.value.previousView=currentView.value; currentView.value='STAFF_TRACKER'; staffTracker.value.isLoading=true;
         google.script.run.withSuccessHandler(res => { 
             staffTracker.value.isLoading=false; 
             if(res.success){ 
                 staffTracker.value.data=res.data; 
                 staffTracker.value.history=res.history; 
                 staffTracker.value.headers=res.headers; 
             } else Swal.fire('Error',res.message,'error'); 
         }).withFailureHandler(handleErr).apiFetchStaffTrackerData(p.name);
      };
      const reloadStaffTracker = () => openStaffTracker({name:staffTracker.value.name});
      const addNewRow = () => { if(!staffTracker.value.headers.length) return; const row={_isNew:true}; staffTracker.value.headers.forEach(h=>row[h]=""); staffTracker.value.data.unshift(row); };
      const saveRow = (row) => { Swal.showLoading(); google.script.run.withSuccessHandler(res => { Swal.close(); if(res.success){ row._isNew=false; if(res.moved){ staffTracker.value.data=staffTracker.value.data.filter(r=>r!==row); staffTracker.value.history.unshift(row); } } }).withFailureHandler(handleErr).apiUpdateTask(staffTracker.value.name, JSON.parse(JSON.stringify(row))); };
      
      const addResponsable = (n) => { selectedResponsables.value.push(n); staffSearch.value=''; };
      const openFileDialog = () => fileInput.value.click();
      const handleFileSelect = (e) => { const file = e.target.files[0]; if(!file) return; isUploadingFile.value=true; const r = new FileReader(); r.onload=(ev)=>google.script.run.withSuccessHandler(res=>{isUploadingFile.value=false;if(res.success){uploadSuccess.value=true;ppcData.value.archivoUrl=res.fileUrl;}}).uploadFileToDrive(ev.target.result,file.type,file.name); r.readAsDataURL(file); };
      const addToQueue = () => { if(!ppcData.value.concepto || !selectedResponsables.value.length) return Swal.fire('Faltan datos','','warning'); const item = JSON.parse(JSON.stringify(ppcData.value)); item.responsable = selectedResponsables.value.join(','); activityQueue.value.push(item); ppcData.value.concepto=''; ppcData.value.cliente=''; ppcData.value.horas=''; selectedResponsables.value=[]; uploadSuccess.value=false; };
      const submitBatch = () => { isSubmitting.value=true; google.script.run.withSuccessHandler(res => { isSubmitting.value=false; if(res.success){ Swal.fire('Guardado','','success'); activityQueue.value=[]; } else Swal.fire('Error',res.message,'error'); }).withFailureHandler(handleErr).apiSavePPCData(JSON.parse(JSON.stringify(activityQueue.value))); };
      
      const fetchSalesData = () => google.script.run.withSuccessHandler(res => { if(res.success) { salesData.value = res.data; salesHeaders.value = res.headers; } }).apiFetchSalesData();
      const filteredStaff = computed(() => config.value.staff.filter(p => p.dept === currentDept.value && p.name.toLowerCase().includes(searchQuery.value.toLowerCase())));
      const filteredDirectory = computed(() => (config.value.directory || config.value.staff).filter(p => p.name.toLowerCase().includes(staffSearch.value.toLowerCase()) && !selectedResponsables.value.includes(p.name)).slice(0,5));
      const currentDeptData = computed(() => config.value.departments[currentDept.value] || {});

      return { isLoggedIn, loginPass, loginUser, loggingIn, doLogin, logout, currentUser, currentView, config, staffTracker, searchQuery, goHome, selectDept, openStaffTracker, reloadStaffTracker, goBackToDept, saveRow, addNewRow, openModule, filteredStaff, getTrafficStyle: (r)=>trafficStyleObj(getTrafficStyle(r)), ppcData, isSubmitting, selectedResponsables, staffSearch, filteredDirectory, addResponsable, addToQueue, activityQueue, submitBatch, currentDeptData, pageTitle: computed(() => currentView.value), openFileDialog, handleFileSelect, fileInput, isUploadingFile, uploadSuccess, closeIframe, salesData, salesHeaders, showSalesModal, fetchSalesData };
    }
  }).mount('#app');
</script>
</body>
</html>
